// ***********************************************************************
// Assembly         : Pedantic.Genetics
// Author           : JoAnn D. Peeler
// Created          : 03-12-2023
//
// Last Modified By : JoAnn D. Peeler
// Last Modified On : 03-28-2023
// ***********************************************************************
// <copyright file="ChessWeights.cs" company="Pedantic.Genetics">
//     Copyright (c) . All rights reserved.
// </copyright>
// <summary>
//     Mapped POCO class for maintaining the weights in the LiteDB 
//     database.
// </summary>
// ***********************************************************************
using Pedantic.Utilities;

namespace Pedantic.Genetics
{
    public sealed class ChessWeights
    {
        public static readonly Guid DEFAULT_IMMORTAL_ID = new("da5e310e-b0dc-4c77-902c-5a46cc81bb73");
        public const int MAX_WEIGHTS = 3526;
        public const int ENDGAME_WEIGHTS = 1763;
        public const int PIECE_WEIGHT_LENGTH = 6;
        public const int PIECE_SQUARE_LENGTH = 1536;
        public const int PIECE_VALUES = 0;
        public const int PIECE_SQUARE_TABLE = 6;
        public const int PIECE_MOBILITY = 1542;
        public const int KING_ATTACK = 1546;
        public const int PAWN_SHIELD = 1549;
        public const int ISOLATED_PAWN = 1552;
        public const int BACKWARD_PAWN = 1553;
        public const int DOUBLED_PAWN = 1554;
        public const int CONNECTED_PAWN = 1555;
        public const int KNIGHT_OUTPOST = 1619;
        public const int BISHOP_OUTPOST = 1620;
        public const int BISHOP_PAIR = 1621;
        public const int ROOK_ON_OPEN_FILE = 1622;
        public const int ROOK_ON_HALF_OPEN_FILE = 1623;
        public const int ROOK_BEHIND_PASSED_PAWN = 1624;
        public const int DOUBLED_ROOKS_ON_FILE = 1625;
        public const int KING_ON_OPEN_FILE = 1626;
        public const int KING_ON_HALF_OPEN_FILE = 1627;
        public const int CASTLING_AVAILABLE = 1628;
        public const int CASTLING_COMPLETE = 1629;
        public const int CENTER_CONTROL = 1630;
        public const int QUEEN_ON_OPEN_FILE = 1632;
        public const int QUEEN_ON_HALF_OPEN_FILE = 1633;
        public const int ROOK_ON_7TH_RANK = 1634;
        public const int PASSED_PAWN = 1635;
        public const int BAD_BISHOP_PAWN = 1699;

        public ChessWeights(Guid _id, bool isActive, bool isImmortal, string description, short[] weights, 
            float fitness, int sampleSize, float k, short totalPasses, DateTime updatedOn, DateTime createdOn)
        {
            Id = _id;
            IsActive = isActive;
            IsImmortal = isImmortal;
            Description = description;
            Weights = weights;
            Fitness = fitness;
            SampleSize = sampleSize;
            K = k;
            TotalPasses = totalPasses;
            UpdatedOn = updatedOn;
            CreatedOn = createdOn;
        }

        public ChessWeights(ChessWeights other)
        {
            Id = Guid.NewGuid();
            IsActive = other.IsActive;
            IsImmortal = other.IsImmortal;
            Description = other.Description;
            Weights = ArrayEx.Clone(other.Weights);
            Fitness = other.Fitness;
            SampleSize = other.SampleSize;
            K = other.K;
            TotalPasses = other.TotalPasses;
            UpdatedOn = DateTime.UtcNow;
            CreatedOn = DateTime.UtcNow;
        }

        public ChessWeights(short[] weights)
        {
            Id = Guid.NewGuid();
            IsActive = true;
            IsImmortal = false;
            Description = "Anonymous";
            Weights = ArrayEx.Clone(weights);
            Fitness = 0;
            SampleSize = 0;
            K = 0;
            TotalPasses = 0;
            UpdatedOn = DateTime.UtcNow;
            CreatedOn = DateTime.UtcNow;
        }

        public ChessWeights()
        {
            Id = Guid.NewGuid();
            IsActive = false;
            IsImmortal = false;
            Description = string.Empty;
            Weights = Array.Empty<short>();
            Fitness = default;
            SampleSize = default;
            K = default;
            TotalPasses = default;
            UpdatedOn = DateTime.UtcNow;
            CreatedOn = DateTime.UtcNow;
        }

        public Guid Id { get; set; }
        public bool IsActive { get; set; }
        public bool IsImmortal { get; set; }
        public string Description { get; set; }
        public short[] Weights { get; init; }
        public float Fitness { get; set; }
        public int SampleSize { get; set; }
        public float K { get; set; }
        public short TotalPasses { get; set; }
        public DateTime UpdatedOn { get; set; }

        public DateTime CreatedOn { get; set; }

        public static ChessWeights Empty { get; } = new ChessWeights();

        public static ChessWeights CreateParagon()
        {
            ChessWeights paragon = new(paragonWeights)
            {
                Id = DEFAULT_IMMORTAL_ID,
                IsImmortal = true,
                Fitness = 0,
                SampleSize = 0,
                K = 0,
                TotalPasses = 0,
                UpdatedOn = DateTime.UtcNow
            };
            return paragon;
        }

        public static bool LoadParagon(out ChessWeights paragon)
        {
            var rep = new ChessDb();
            ChessWeights? p = rep.Weights.GetAll().FirstOrDefault(w => w.IsActive && w.IsImmortal);
            if (p == null)
            {
                p = CreateParagon();
                rep.Weights.Insert(p);
                rep.Save();
                paragon = p;
            }
            else
            {
                paragon = p;
            }
            return true;
        }

        // Solution sample size: 12000000, generated on Tue, 05 Sep 2023 16:56:08 GMT
        // Solution error: 0.119748, accuracy: 0.5132, seed: -1871386134
        private static readonly short[] paragonWeights =
        {
            /*------------------- OPENING WEIGHTS -------------------*/

            /* opening piece values */
            111, 436, 484, 601, 1456, 0,

            /* opening piece square values */

            #region opening piece square values

            /* pawns: KK */
               0,    0,    0,    0,    0,    0,    0,    0,
             -26,  -40,  -22,    3,  -38,   42,   47,   -5,
             -25,  -25,  -14,  -11,  -11,    7,   13,   -4,
             -20,  -21,   -2,   -1,   15,   20,   -1,   -6,
             -15,   -7,   17,   22,   41,   51,   30,   14,
             -12,   12,   14,   55,   42,  144,  134,   55,
              92,   98,  102,  111,   40,   10,  -61,  -14,
               0,    0,    0,    0,    0,    0,    0,    0,

            /* pawns: KQ */
               0,    0,    0,    0,    0,    0,    0,    0,
             -45,  -73,  -45,  -49,  -30,   29,   48,   -4,
             -38,  -58,  -30,  -34,   -4,   -5,   20,    4,
             -18,  -11,   -5,   -4,   -4,  -12,  -17,    4,
             -21,   15,   21,   27,    5,  -15,    5,    2,
              58,  108,  118,   34,   47,   25,   60,   12,
              38, -102,   52,   15,   91,  104,  193,  222,
               0,    0,    0,    0,    0,    0,    0,    0,

            /* pawns: QK */
               0,    0,    0,    0,    0,    0,    0,    0,
              -5,   22,    3,  -20,  -44,  -16,  -28,  -44,
              12,   27,   -1,    0,  -20,   -9,  -29,  -43,
               4,    7,   -9,   -9,    0,    5,  -11,  -20,
              -9,   -5,   10,   10,   33,   40,   12,   -9,
              -5,   20,   32,   48,   59,  151,  120,   22,
             144,  175,  132,  130,   88,   39,    0,  -28,
               0,    0,    0,    0,    0,    0,    0,    0,

            /* pawns: QQ */
               0,    0,    0,    0,    0,    0,    0,    0,
             -28,  -10,   27,    5,   -8,   -6,  -17,   -5,
             -24,  -12,    0,  -18,    7,  -24,  -24,  -23,
             -14,  -14,    6,    5,   24,    0,  -12,  -27,
              34,   65,   53,   33,   24,   16,   13,    4,
             105,   73,  104,   32,    2,   28,   20,   45,
              95,    9,   69,   17,  109,   27,  250,  169,
               0,    0,    0,    0,    0,    0,    0,    0,

            /* knights: KK */
            -108,  -19,  -47,  -25,   -8,    2,  -14,  -67,
             -41,  -48,  -13,    7,    7,   16,   -9,   -3,
             -27,  -14,  -11,   17,   27,   -4,    1,   -6,
             -12,    3,    5,    6,   15,   23,   27,    7,
               6,   -9,   21,   31,  -11,    9,  -24,   50,
             -29,   35,   35,   42,   93,  148,   37,  -16,
             -12,   -4,   21,   51,   41,  104,   32,    5,
            -256,  -39,  -12,   34,   59,  -99,   13, -201,

            /* knights: KQ */
             -72,  -40,  -55,  -50,  -31,  -31,  -24,  -33,
             -73,  -36,  -25,   14,   -8,    4,  -64,  -37,
             -46,  -19,  -19,    6,   22,    4,  -21,  -22,
             -16,   25,   23,   34,   20,    5,   -3,   -9,
              53,  -17,   28,   45,   51,   40,   19,    2,
              29,   63,   81,   63,   59,   51,    4,   -8,
               3,   20,    4,   60,   16,   70,  -10,  -30,
            -222,    0,  -11,   37,  -47,  -12,  -27, -126,

            /* knights: QK */
             -83,  -53,  -40,  -62,  -32,  -22,  -48, -121,
             -38,  -20,    5,   -5,  -13,   -4,  -61,  -10,
             -23,   -8,   12,   53,   49,  -30,    2,  -49,
              34,   32,   35,   20,   36,   16,    4,   -3,
              10,   27,   57,  102,   43,   41,   21,   62,
               5,   20,   23,   88,   86,  127,   33,   16,
             -20,    6,   51,   37,   -2,   75,   -9,   89,
            -134,  -32,  -24,   18,    1,  -13,  -75,  -58,

            /* knights: QQ */
               0,  -43,   22,  -46,  -43,  -51,  -40,  -86,
             -39,  -26,    3,   25,  -22,    6,  -10, -120,
              11,   -4,   12,   22,   22,  -27,  -24,  -22,
              22,   15,   48,   50,   26,    7,   47,  -33,
              32,  -18,   17,   49,   44,   38,   37,   11,
              93,  -41,    9,  117,   44,   27,   41,   16,
             -17,   48,   15,   25,   45,   58,  -23,  -46,
            -134,   -6,  -31,   15,  -37,   41,    6,  -99,

            /* bishops: KK */
              -2,   12,  -10,  -28,   -9,    0,   -5,  -19,
              18,    6,   14,    0,    5,   17,   34,   16,
              -7,    9,   14,   10,    6,    4,    6,    0,
              -9,  -12,   -2,   26,   24,  -15,   -6,   16,
             -13,   -3,   -2,   36,   15,   20,  -17,   -7,
               0,   13,   -8,  -13,    6,   63,   46,  -17,
             -49,  -32,  -22,  -37,  -20,   -5,  -76,  -52,
             -92,  -50,  -49,  -63,  -42,  -61,  -18,  -50,

            /* bishops: KQ */
             -73,   -1,  -30,  -44,   -7,   -5,   68,  -20,
             -44,  -13,  -20,   -1,    5,   27,   64,    7,
             -31,  -14,   20,   10,   17,   35,   27,   29,
              26,    0,   -1,   42,   56,   20,   -5,  -26,
               5,   17,   16,   94,   58,   16,    7,    3,
              -8,   70,   93,   23,   28,   35,   26,   14,
             -43,    3,  -54,  -32,  -27,   -9,   -3,  -57,
             -21,   -6,   15,   -9,  -30,   -6,   -1,  -37,

            /* bishops: QK */
               8,   16,   14,  -20,  -25,  -26,  -29, -126,
              34,   56,   19,   24,  -12,  -30,  -35,  -20,
               0,   34,   34,   23,    9,   -2,    0,   -6,
              -5,   13,    8,   65,   45,  -14,  -14,  -21,
             -24,   13,   41,   85,   36,   23,   14,   -8,
             -43,    5,   22,   20,   45,   82,   82,   11,
             -21,  -47,  -27,  -36,  -27,  -29,   -4,  -33,
             -62,  -45,  -26,  -26,  -27,  -55,   19,  -36,

            /* bishops: QQ */
             -65,  -56,  -10,  -52,  -20,  -19,   18,  -42,
              17,   40,  -18,   10,  -36,   13,  -19,   61,
               6,   14,   20,   13,   21,   12,   15,   -7,
              29,   32,    5,   57,   15,   30,   -5,    8,
              16,    5,   17,   57,   62,   -3,    8,   -5,
             -12,   72,   75,   34,    9,   60,   -2,   -9,
             -45,    1,   26,    8,   18,  -26,   44,  -44,
             -35,   14,  -12,   -9,   25,   -1,   -2,  -12,

            /* rooks: KK */
             -14,   -5,   -7,    3,   12,   11,   22,   -8,
             -36,  -16,  -19,   -8,   -5,   14,   36,    3,
             -39,  -39,  -32,  -24,   -3,  -10,   26,    4,
             -38,  -33,  -26,  -16,  -21,  -41,   11,  -29,
             -11,   -9,   -1,   33,   -4,   26,   51,   22,
              -1,   46,   41,   36,   75,  122,  129,   70,
             -28,  -30,   -4,   25,    7,   62,   80,  107,
              87,   87,   52,   62,   51,   77,   93,  102,

            /* rooks: KQ */
             -18,   18,    0,   -7,  -15,    2,   -2,  -25,
             -50,   -2,  -26,  -24,  -22,  -40,  -31,  -24,
             -30,   -9,  -41,  -19,  -42,  -23,  -12,  -34,
             -48,  -14,  -48,   -9,  -34,  -60,  -14,   -3,
               5,   34,  -15,  -15,   26,   14,   30,   10,
              75,  112,   56,   60,   57,   45,   99,   23,
              20,   32,   24,   17,   32,    4,   33,   63,
              35,   59,   45,   43,   31,   33,   86,   63,

            /* rooks: QK */
             -62,  -14,  -16,   -7,   -2,    8,   17,  -21,
             -33,  -52,  -41,  -26,  -38,  -38,   -6,  -12,
             -28,   -5,  -32,  -35,  -59,  -76,  -18,  -15,
               0,   34,  -45,  -36,  -56,  -55,   10,  -17,
              39,   15,   40,   -4,  -28,   -3,   20,   33,
              41,   88,   53,    1,   65,   66,  122,   65,
              17,   29,   36,  -10,  -31,   64,   44,   49,
             174,   90,   56,   36,   31,   40,   89,   87,

            /* rooks: QQ */
             -32,  -19,   17,   29,    4,   -7,  -14,  -21,
             -29,  -37,  -27,   -6,  -42,  -39,  -16,   -9,
             -83,   23,   -7,  -14,  -20,  -52,  -47,  -48,
             -27,    6,  -32,  -17,  -50,  -21,  -51,  -13,
              31,   50,   -9,   74,   19,   26,   -6,    6,
              63,   90,  112,   94,   63,   53,   30,   20,
              55,   70,   15,   46,  126,   56,    7,   13,
              47,   58,    3,   32,  -23,   77,   96,   34,

            /* queens: KK */
              11,   13,   24,   25,   44,   18,  -51,  -25,
              -8,   14,   15,   20,   23,   44,   28,   13,
              -3,    1,    0,   -8,    9,   -5,    7,    7,
              -6,  -22,  -20,  -31,  -26,  -26,   -1,  -31,
              -7,   -7,  -48,  -42,  -46,  -37,  -29,  -27,
             -10,    3,  -45,  -59,  -28,   60,   36,   -4,
             -31,  -55,  -42,  -35,  -62,   63,   21,   84,
             -22,   15,    7,   -1,   13,   89,  114,   95,

            /* queens: KQ */
              22,   18,   26,   17,   15,    3,  -24,  -28,
              39,   14,   32,   17,   11,   11,  -49,  -33,
              12,   -2,   23,    0,    3,    4,  -13,  -23,
              -8,   38,  -42,  -36,  -16,  -24,  -33,  -11,
             -12,   -7,  -20,  -11,   10,  -22,   -6,    0,
              38,   82,   59,   49,   10,    6,   53,   16,
              52,  103,   53,   63,   45,   -2,    3,   13,
              71,   69,   82,  102,   20,   50,   28,   -3,

            /* queens: QK */
             -87,  -79,   -8,   -5,    5,   -6,  -20,  -33,
             -57,  -40,   27,   13,   12,   -8,   38,    9,
             -53,   -3,   -2,  -23,    6,  -22,   -1,    1,
             -15,  -46,  -22,  -22,  -28,  -28,    4,  -23,
              -3,  -27,  -35,  -37,  -33,   15,   -2,    0,
              -1,    3,    3,  -22,   36,   46,   36,   32,
               0,    8,  -46,  -37,   -5,    0,   55,   47,
             -22,   45,   25,   40,  -31,   42,   80,   53,

            /* queens: QQ */
             -55,  -42,  -28,  -28,   24,  -11,  -41,  -46,
             -69,  -43,   10,   16,  -27,  -30,   10,  -32,
              -4,   -2,   11,   -7,  -22,  -31,  -10,  -26,
             -22,   28,  -30,    2,  -15,  -29,  -16,  -29,
             -40,   -6,   25,    6,   48,    9,   -7,    9,
              28,   59,  103,   61,   21,  -12,    3,    7,
              96,   92,  113,   51,   36,    1,   11,  -37,
              19,  101,   18,   26,   10,   14,   37,   27,

            /* kings: KK */
               0,    0,    0,    0,  -49,  -65,   11,    6,
               0,    0,    0,    0,  -15,   -2,   23,    7,
               0,    0,    0,    0,   40,   -9,   -5,  -44,
               0,    0,    0,    0,  130,   70,   44,  -74,
               0,    0,    0,    0,  238,  226,  165,   47,
               0,    0,    0,    0,  213,  323,  255,   84,
               0,    0,    0,    0,  179,  190,   95,   55,
               0,    0,    0,    0,   79,   58,   40,   -3,

            /* kings: KQ */
               0,    0,    0,    0,  -79, -102,    6,   -8,
               0,    0,    0,    0,  -21,   -9,    9,    1,
               0,    0,    0,    0,   -7,   11,   -3,  -47,
               0,    0,    0,    0,   86,   71,   11,  -17,
               0,    0,    0,    0,  170,  121,   97,   12,
               0,    0,    0,    0,  151,  106,  112,    3,
               0,    0,    0,    0,  194,  214,  136,   23,
               0,    0,    0,    0,   95,   98,  155,  -19,

            /* kings: QK */
             -26,    3,  -42, -118,    0,    0,    0,    0,
              12,  -13,  -34,  -49,    0,    0,    0,    0,
             -49,  -35,    0,  -35,    0,    0,    0,    0,
             -17,   22,   62,   55,    0,    0,    0,    0,
              15,   67,   83,  142,    0,    0,    0,    0,
              30,   92,  137,  133,    0,    0,    0,    0,
              42,  172,  104,  124,    0,    0,    0,    0,
              -1,   60,  171,   48,    0,    0,    0,    0,

            /* kings: QQ */
             -81,   -8,  -51,  -84,    0,    0,    0,    0,
             -17,  -23,   -5,  -27,    0,    0,    0,    0,
             -37,   -4,    0,   15,    0,    0,    0,    0,
              -7,   48,   42,   93,    0,    0,    0,    0,
              39,  110,  207,  184,    0,    0,    0,    0,
              48,  192,  154,  173,    0,    0,    0,    0,
              28,   49,   92,   68,    0,    0,    0,    0,
             -64,   43,   46,   76,    0,    0,    0,    0,

            #endregion

            /* opening mobility weights */

            10, // knights
            5, // bishops
            2, // rooks
            -1, // queens

            /* opening squares attacked near enemy king */
            24, // attacks to squares 1 from king
            21, // attacks to squares 2 from king
            7, // attacks to squares 3 from king

            /* opening pawn shield/king safety */
            28, // # friendly pawns 1 from king
            16, // # friendly pawns 2 from king
            9, // # friendly pawns 3 from king

            /* opening isolated pawns */
            -11,

            /* opening backward pawns */
            -16,

            /* opening doubled pawns */
            -16,

            /* opening adjacent/connected pawns */
               0,    0,    0,    0,    0,    0,    0,    0,
              17,   -3,    3,   17,   26,    2,  -22,   -2,
              11,    8,    1,    9,   29,    1,    2,  -10,
               8,   21,    8,   19,   30,   46,   18,   39,
              37,   38,   45,   40,   92,   90,   37,   58,
              82,  152,  242,  202,  219,  228,  208,  122,
             135,  251,  283,  287,  289,  243,   96,   94,
               0,    0,    0,    0,    0,    0,    0,    0,

            /* opening knight on outpost */
            3,

            /* opening bishop on outpost */
            11,

            /* opening bishop pair */
            37,

            /* opening rook on open file */
            37,

            /* opening rook on half-open file */
            14,

            /* opening rook behind passed pawn */
            -4,

            /* opening doubled rooks on file */
            9,

            /* opening king on open file */
            -71,

            /* opening king on half-open file */
            -34,

            /* opening castling rights available */
            30,

            /* opening castling complete */
            18,

            /* opening center control */
            3, // D0
            4, // D1

            /* opening queen on open file */
            -11,

            /* opening queen on half-open file */
            10,

            /* opening rook on seventh rank */
            40,

            /* opening passed pawn */
               0,    0,    0,    0,    0,    0,    0,    0,
              -3,  -18,  -30,  -40,   20,   -3,  -10,   36,
              -5,   -4,  -23,  -28,  -34,  -35,  -34,   13,
              19,   16,   -7,   10,  -15,  -19,  -30,   -3,
              65,   65,   37,   35,   23,   28,   33,   29,
             142,  120,  122,   50,   77,   92,   -2,   16,
             136,  147,  106,  129,  141,  129,   47,   53,
               0,    0,    0,    0,    0,    0,    0,    0,

            /* opening bad bishop pawns */
               0,    0,    0,    0,    0,    0,    0,    0,
              -6,   -2,   -8,  -11,  -14,  -23,  -17,    3,
              -7,   -7,  -13,   -5,   -9,  -12,  -13,   -4,
              -7,    4,    2,   -1,  -18,   -7,   -9,   -1,
               4,    5,    6,    4,    0,    7,   -5,    6,
              18,   21,   25,   10,   33,    7,   69,   -5,
              34,   40,   53,   58,   48,   52,   19,   66,
               0,    0,    0,    0,    0,    0,    0,    0,


            /*------------------- END GAME WEIGHTS -------------------*/

            /* end game piece values */
            167, 458, 514, 899, 1524, 0,

            /* end game piece square values */

            #region end game piece square values

            /* pawns: KK */
               0,    0,    0,    0,    0,    0,    0,    0,
               6,    9,    5,  -21,   31,    9,  -11,  -33,
              -2,   -4,   -8,   -4,    1,   -8,  -15,  -32,
               6,   10,  -13,  -31,  -32,  -16,   -8,  -31,
              38,   26,   10,  -28,  -31,  -18,    7,  -11,
              67,   65,   66,   36,   29,    2,   19,  -16,
             147,   99,  107,   49,   38,    7,   18,   12,
               0,    0,    0,    0,    0,    0,    0,    0,

            /* pawns: KQ */
               0,    0,    0,    0,    0,    0,    0,    0,
              17,   40,   30,   65,   -1,  -12,  -27,  -12,
               3,   24,    6,    8,  -19,  -15,  -29,  -23,
              -7,    0,  -13,  -12,  -16,    6,    2,   -7,
               3,  -24,  -20,  -18,    8,   62,   57,   59,
             -32,  -73,  -55,    5,  100,  161,  178,  158,
               3,    1,  -34,   28,  147,  218,  196,  197,
               0,    0,    0,    0,    0,    0,    0,    0,

            /* pawns: QK */
               0,    0,    0,    0,    0,    0,    0,    0,
              -9,  -28,   -5,   -1,   22,   28,   34,   33,
             -14,  -26,  -10,  -22,    9,   -1,    7,   13,
              12,   21,   14,   -6,   -7,   -9,   -7,  -12,
              67,   67,   57,   13,   -9,  -17,    2,    4,
             121,  138,  146,   91,   34,   -1,    3,    3,
             151,  148,  205,  137,   40,    3,  -42,    9,
               0,    0,    0,    0,    0,    0,    0,    0,

            /* pawns: QQ */
               0,    0,    0,    0,    0,    0,    0,    0,
             -19,  -18,  -13,    0,   -3,   -3,    2,    2,
             -17,  -15,  -11,  -10,  -15,  -26,  -18,   -9,
             -13,   -1,  -21,  -14,  -29,  -25,  -11,   -8,
             -22,  -29,  -22,  -13,   -7,    9,    7,   26,
             -58,  -45,  -42,    4,   69,   84,  100,   78,
              -6,    6,  -24,   23,   73,  136,   97,  141,
               0,    0,    0,    0,    0,    0,    0,    0,

            /* knights: KK */
             -53, -101,  -32,  -21,  -29,  -32,  -39,  -67,
             -47,   -2,  -21,  -29,  -20,  -10,   -5,  -24,
             -34,   -6,   -1,   25,   12,   -9,   -1,   14,
               9,   12,   40,   53,   57,   43,   36,   20,
              18,   16,   23,   46,   49,   66,   73,   29,
              32,    6,   18,   21,    9,   -7,   45,   42,
              20,   18,   16,   29,   31,  -18,    3,   14,
              12,   31,   27,   35,   23,   23,   12,  -72,

            /* knights: KQ */
             -85,  -35,    1,   17,   -8,  -18,   -2, -118,
             -13,    4,  -13,  -27,  -17,   -3,   18,  -22,
               5,  -20,    3,    4,    2,  -35,    8,   11,
              12,   -9,   17,   10,   24,   20,   14,   22,
             -40,    1,   -3,    6,    0,    5,    1,    6,
             -25,  -68,  -47,  -17,   -5,    7,   25,   14,
             -32,  -19,  -44,  -10,  -10,   -6,   20,    7,
            -149,  -53,  -29,    1,  -11,   44,   27,  -28,

            /* knights: QK */
             -98,    3,   -1,   29,   -6,  -18,  -42,  -39,
             -44,   -4,  -21,  -10,    1,   -2,   -1,  -47,
              27,  -18,  -15,   -3,   -9,    3,  -19,  -35,
               3,   15,   17,   39,   10,   16,    2,  -19,
              36,   18,   11,    5,   16,   14,   -2,  -17,
              39,   23,   31,  -24,   -9,  -29,    1,  -20,
              26,    8,   28,   45,   17,  -13,  -15,  -14,
             -74,   17,   35,   -4,   20,  -19,  -15,  -98,

            /* knights: QQ */
             -87,    1,  -15,    6,    4,    5,  -51,  -59,
             -17,   37,  -30,   -9,   -6,  -45,    3,  -18,
               4,   -6,  -25,    4,   -3,  -13,    8,  -44,
              56,   19,   14,   -4,    5,    5,    5,   17,
              17,   31,    0,    8,    9,   -3,  -13,   14,
               1,   13,  -14,  -15,   -8,   28,   -5,  -11,
              46,    8,   11,   46,   26,   12,   28,   36,
             -75,   63,   29,   47,   12,   46,   65,  -25,

            /* bishops: KK */
             -21,  -38,  -31,   15,    6,    4,  -24,  -35,
             -12,  -13,  -12,   10,    2,   -5,  -30,  -66,
               3,   12,   33,   22,   46,   15,   -2,   -5,
              16,   34,   38,   22,    8,   30,    4,  -26,
              34,   13,   18,    9,   16,   20,   27,   28,
              11,   20,   20,   19,   19,   26,   14,   57,
              33,   28,   29,   40,   25,   21,   12,   10,
              55,   41,   46,   61,   40,   22,    7,   12,

            /* bishops: KQ */
              45,   29,    6,   13,   -7,  -15,  -84,  -57,
              23,    2,   20,    8,   -4,  -24,  -32,  -53,
              15,   13,   13,   10,   15,   -5,    2,  -14,
              11,   14,    8,  -12,    2,   31,   27,   31,
              20,   -3,  -16,  -59,    4,   23,   30,   17,
              -4,  -28,  -24,   -5,    3,    5,   18,   19,
             -39,  -14,   12,    2,   11,    9,   28,   54,
             -14,    3,  -16,   13,   20,   21,   28,   29,

            /* bishops: QK */
             -16,  -21,   -3,   13,   25,    1,   38,   17,
             -14,  -19,    6,    1,   11,   26,   -1,    3,
              17,    8,   16,   17,   34,    2,    0,  -18,
               5,   23,   40,   -3,  -14,   34,   17,   21,
              44,   23,    8,  -13,   -3,   14,   -8,   12,
              40,   38,   17,   26,   20,    1,  -40,    1,
              38,   30,   38,   47,   18,   28,  -24,  -38,
              24,   27,   32,   36,   13,    2,    7,   23,

            /* bishops: QQ */
              28,   18,   -8,   -5,    0,  -26,  -25,  -27,
             -10,  -23,    4,    1,   19,  -27,  -15,  -62,
              12,    2,    2,   -6,    1,  -10,  -28,   -9,
              17,    3,  -11,  -31,  -19,   -3,  -12,  -20,
               9,   -1,  -22,  -30,  -45,   -1,  -16,    6,
              -5,  -11,  -29,  -13,    9,  -22,    4,    5,
             -18,  -16,   -8,   14,   -7,   -1,   -5,   17,
               7,   -5,   -4,   15,   24,   10,   17,   33,

            /* rooks: KK */
              35,   24,   19,   -7,  -24,   -2,   -2,  -22,
              34,   20,   13,  -11,  -22,  -30,  -14,   -9,
              34,   34,   11,  -14,  -35,  -12,  -25,  -16,
              58,   48,   31,   12,   -9,   30,   16,   20,
              70,   58,   38,    3,   22,   19,   24,   26,
              77,   49,   39,   17,   -4,   11,   16,   22,
              66,   72,   31,    5,   21,   21,   42,   18,
              43,   53,   38,    9,   37,   53,   60,   44,

            /* rooks: KQ */
             -16,  -34,  -31,  -24,  -16,  -23,    9,    5,
               0,  -43,  -29,  -38,  -20,    5,   12,    2,
              -9,  -31,  -32,  -47,  -26,  -24,   -6,  -12,
               3,  -16,   -9,  -24,  -13,   27,   16,   -5,
              -4,  -16,   -3,    2,  -26,    5,   10,   23,
              -4,  -19,  -32,  -29,  -34,    7,   -1,   30,
               2,    2,  -19,  -14,  -11,    3,   21,   10,
              33,   14,  -10,   -4,   -3,   18,   31,   23,

            /* rooks: QK */
              25,    3,   -1,  -32,  -38,  -46,  -40,   -7,
               7,   15,   14,  -23,  -31,  -30,  -42,  -36,
               7,    1,   -3,  -30,  -12,  -13,  -41,  -48,
               1,   -6,   22,   -7,    4,    6,  -12,  -12,
              14,   37,   -1,   10,    0,   -4,   -6,  -33,
              29,   15,   13,   12,  -26,  -10,  -25,  -11,
              24,   17,   12,    4,   11,  -14,   11,   -9,
             -77,   11,   12,   14,   10,    2,    2,   -6,

            /* rooks: QQ */
             -12,  -14,  -49,  -83,  -51,  -14,   -4,   24,
             -18,  -10,  -24,  -58,  -43,  -42,  -32,  -13,
               5,  -45,  -33,  -52,  -33,  -45,    0,    6,
               4,  -10,  -12,  -31,  -33,  -25,    2,   14,
             -10,   -7,    4,  -33,  -18,  -12,   25,   12,
               1,    5,  -16,  -34,  -30,    6,   11,   19,
               7,    5,   18,  -29,  -57,  -35,   15,   23,
              30,   30,   18,   11,   -3,  -17,   24,   27,

            /* queens: KK */
             -21,  -33,  -68,  -49, -109, -114,  -77,  -19,
              16,  -11,  -20,  -39,  -44,  -83,  -73,  -66,
             -21,    0,    7,   -4,  -17,   20,   19,  -12,
              14,   38,   18,   36,   18,   49,   45,   82,
              33,   26,   67,   48,   72,  110,  117,  137,
              39,   61,   81,   88,   99,   98,  131,  174,
              78,  124,   90,   73,  123,   67,  184,  128,
              55,   51,   51,   65,   76,   69,  105,   98,

            /* queens: KQ */
             -28,  -26,  -83,  -42,  -18,  -68,  -44,   -3,
               3,    4,  -50,  -25,  -26,  -58,  -12,  -50,
               8,    7,  -59,   -6,   -7,   40,   21,  -23,
              36,  -45,   21,    1,   10,   31,   49,   27,
              26,   20,    2,   -7,   -4,   35,   44,   76,
              20,    5,   13,  -11,   25,   57,   55,   41,
              26,   13,   29,   19,   19,   67,   81,   58,
              49,   83,   54,   49,   77,   46,   58,   16,

            /* queens: QK */
             -81,  -44, -101,  -57,  -81,  -64,  -33,   -7,
             -22,  -70,  -70,  -26,  -56,  -28,  -53,  -11,
              -8,  -16,    2,   21,  -23,   -2,  -23,    9,
             -17,   36,   33,    1,   13,    1,   -2,   23,
              26,   34,   65,   43,   22,    5,   12,   -8,
               8,   79,   31,   49,   11,   32,   51,   22,
               2,   37,   92,   51,   17,   32,   26,   34,
              50,   25,   23,   19,   30,   64,   35,   39,

            /* queens: QQ */
             -93,  -65,  -20,  -45,  -43,  -37,  -33,  -23,
              -1,  -46,  -28,  -33,  -12,  -40,  -53,  -33,
               5,    7,  -32,  -38,  -28,   -4,  -45,  -30,
             -30,   10,   15,  -24,  -11,  -56,  -34,   21,
              40,   25,   14,   23,   -4,   -6,    1,  -30,
              35,   40,   50,    3,   -3,    8,   19,   66,
              26,   50,   49,   55,   27,   -4,   57,   36,
             -23,   62,   66,   17,   13,  -10,   11,  -22,

            /* kings: KK */
               0,    0,    0,    0,  -16,   -1,  -34,  -80,
               0,    0,    0,    0,   15,    7,   -9,  -27,
               0,    0,    0,    0,   26,   25,    8,  -12,
               0,    0,    0,    0,   23,   32,   19,   10,
               0,    0,    0,    0,    7,    2,   17,    8,
               0,    0,    0,    0,   15,   -9,   28,   27,
               0,    0,    0,    0,    7,    4,   70,   35,
               0,    0,    0,    0,    8,   31,   48,  -91,

            /* kings: KQ */
               0,    0,    0,    0,    1,    3,  -55,  -74,
               0,    0,    0,    0,   12,   -1,   -8,  -35,
               0,    0,    0,    0,   29,   14,    9,  -10,
               0,    0,    0,    0,   31,   34,   41,    8,
               0,    0,    0,    0,   33,   50,   51,   42,
               0,    0,    0,    0,   44,   61,   55,   54,
               0,    0,    0,    0,   14,    9,   27,   20,
               0,    0,    0,    0,    4,    0,  -37,  -27,

            /* kings: QK */
             -78,  -74,  -47,  -14,    0,    0,    0,    0,
             -64,  -22,  -19,  -11,    0,    0,    0,    0,
             -32,    4,   -8,   12,    0,    0,    0,    0,
              -7,   19,   17,   18,    0,    0,    0,    0,
               8,   42,   36,   15,    0,    0,    0,    0,
              23,   41,   33,   18,    0,    0,    0,    0,
              -4,    5,   25,   18,    0,    0,    0,    0,
             -33,   13,   -8,   14,    0,    0,    0,    0,

            /* kings: QQ */
              23,  -28,  -19,  -28,    0,    0,    0,    0,
             -18,   -6,  -16,  -24,    0,    0,    0,    0,
             -16,   -9,   -7,   -4,    0,    0,    0,    0,
             -17,    4,   17,   10,    0,    0,    0,    0,
              -5,   13,    4,    8,    0,    0,    0,    0,
              17,   22,   -4,    9,    0,    0,    0,    0,
              -9,   60,   16,   26,    0,    0,    0,    0,
            -110,   38,    3,   19,    0,    0,    0,    0,

            #endregion

            /* end game mobility weights */

            10, // knights
            6, // bishops
            4, // rooks
            6, // queens

            /* end game squares attacked near enemy king */
            -5, // attacks to squares 1 from king
            -3, // attacks to squares 2 from king
            0, // attacks to squares 3 from king

            /* end game pawn shield/king safety */
            10, // # friendly pawns 1 from king
            16, // # friendly pawns 2 from king
            10, // # friendly pawns 3 from king

            /* end game isolated pawns */
            -8,

            /* end game backward pawns */
            -13,

            /* end game doubled pawns */
            -45,

            /* end game adjacent/connected pawns */
               0,    0,    0,    0,    0,    0,    0,    0,
               1,    2,   -2,    1,   10,  -21,   20,  -25,
              -3,    5,   19,   27,   -3,   14,    8,   -7,
              13,   14,   45,   75,   33,   32,    5,   20,
              76,   61,   92,   91,   80,   42,   45,   42,
             106,  123,  160,  164,  109,  176,   55,   36,
             278,  404,  443,  442,  550,  327,  322,  299,
               0,    0,    0,    0,    0,    0,    0,    0,

            /* end game knight on outpost */
            31,

            /* end game bishop on outpost */
            28,

            /* end game bishop pair */
            111,

            /* end game rook on open file */
            5,

            /* end game rook on half-open file */
            29,

            /* end game rook behind passed pawn */
            30,

            /* end game doubled rooks on file */
            16,

            /* end game king on open file */
            5,

            /* end game king on half-open file */
            44,

            /* end game castling rights available */
            -28,

            /* end game castling complete */
            -18,

            /* end game center control */
            8, // D0
            5, // D1

            /* end game queen on open file */
            35,

            /* end game queen on half-open file */
            17,

            /* end game rook on seventh rank */
            32,

            /* end game passed pawn */
               0,    0,    0,    0,    0,    0,    0,    0,
              23,   34,   25,   32,   -8,    5,   31,    5,
              30,   33,   21,   13,   19,   25,   49,   22,
              74,   67,   47,   33,   37,   48,   82,   70,
             110,  101,   70,   57,   63,   50,   74,   84,
             153,  160,  102,   92,   71,   60,  101,  115,
             137,  183,  158,  136,  151,  136,  194,  147,
               0,    0,    0,    0,    0,    0,    0,    0,

            /* end game bad bishop pawns */
               0,    0,    0,    0,    0,    0,    0,    0,
               6,    1,   -1,  -39,   -7,    0,   -8,   -5,
              -5,  -13,  -19,  -22,  -20,   -7,  -12,   -8,
              -8,  -26,  -40,  -57,  -35,  -30,  -22,   -4,
             -28,  -41,  -43,  -58,  -47,  -43,  -36,  -29,
             -45,  -70,  -78,  -79,  -93,  -73, -119,  -34,
             -61, -102, -106, -138, -177, -147, -157, -133,
               0,    0,    0,    0,    0,    0,    0,    0,
        };
    }
}